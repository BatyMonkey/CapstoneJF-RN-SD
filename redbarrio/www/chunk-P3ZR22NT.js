import{a as K}from"./chunk-DSYC522I.js";import"./chunk-BSJEIMOO.js";import"./chunk-CGH6KSUE.js";import{B as b,D as _,Da as L,E as y,F as x,Fa as R,Ga as B,Ha as F,I as w,Ia as D,Ja as W,Ma as j,O as M,R as P,Ra as A,Ta as z,Ua as U,Z as I,_ as k,ca as E,ha as T,hb as N,i as o,ib as q,j as u,k as v,m as f,n as g,o as n,ob as V,p as r,q as m,qb as H,sa as O,tb as G,u as h,ub as J,v as C,ya as S,z as l}from"./chunk-JZTRD5FY.js";import"./chunk-G4GOZ2R2.js";import"./chunk-2GHFZAQB.js";import"./chunk-QUJFQN2Y.js";import"./chunk-VBARJE22.js";import"./chunk-6T3MRKSY.js";import"./chunk-LG5HFCS7.js";import"./chunk-PTM2QU7L.js";import"./chunk-Z7QLWI7J.js";import"./chunk-DNXVUVY2.js";import"./chunk-JS56SECH.js";import"./chunk-GFYYGWWH.js";import"./chunk-EXVGCGBZ.js";import"./chunk-IACAUHTZ.js";import"./chunk-WIVIOYVM.js";import"./chunk-ULQSOQCK.js";import"./chunk-JOPIHTUJ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-EKNMT7ZB.js";import"./chunk-CKP3SGE2.js";import"./chunk-K6CL52MX.js";import{j as p}from"./chunk-VI73JOY6.js";var X=()=>["/auth/register"];function Y(a,s){if(a&1&&(n(0,"ion-text",19),l(1),r()),a&2){let Q=C();o(),b(" ",Q.errorMsg," ")}}function Z(a,s){a&1&&m(0,"ion-spinner",20)}var ce=(()=>{let s=class s{constructor(i,t,e,c){this.auth=i,this.router=t,this.alertCtrl=e,this.toastCtrl=c,this.email="",this.password="",this.loading=!1,this.errorMsg="",this.loadingRecovery=!1}login(){return p(this,null,function*(){this.loading=!0,this.errorMsg="";try{yield this.auth.signIn(this.email,this.password),this.router.navigateByUrl("/home",{replaceUrl:!0})}catch(i){this.errorMsg=i?.message??"Error al iniciar sesi\xF3n"}finally{this.loading=!1}})}mostrarToast(i,t){return p(this,null,function*(){yield(yield this.toastCtrl.create({message:i,duration:4e3,color:t,position:"top"})).present()})}requestPasswordRecovery(){return p(this,null,function*(){if(!this.email.trim()){yield this.mostrarAlertaEmail();return}yield this.recoverPassword(this.email.trim())})}recoverPassword(i){return p(this,null,function*(){this.loadingRecovery=!0,this.errorMsg="";try{yield this.auth.sendPasswordResetLink(i),yield this.mostrarToast("\xA1Enlace enviado! Revisa tu correo (incluida la carpeta spam).","success")}catch(t){console.error("Error de recuperaci\xF3n:",t?.message,t),this.errorMsg="Error al procesar la solicitud. Verifica el correo e intenta de nuevo.",yield this.mostrarToast(this.errorMsg,"danger")}finally{this.loadingRecovery=!1}})}mostrarAlertaEmail(){return p(this,null,function*(){let i=yield this.alertCtrl.create({header:"Recuperar Contrase\xF1a",message:"Ingresa tu correo electr\xF3nico asociado a la cuenta.",inputs:[{name:"recoveryEmail",type:"email",placeholder:"ejemplo@correo.cl",value:this.email}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Enviar Enlace",handler:t=>p(this,null,function*(){let e=(t?.recoveryEmail||"").trim();return e?(this.email=e,yield i.dismiss(),this.recoverPassword(e),!0):(yield this.mostrarToast("Ingresa un correo v\xE1lido","warning"),!1)})}]});yield i.present()})}goToRegister(){this.loading||this.router.navigateByUrl("/auth/register")}};s.\u0275fac=function(t){return new(t||s)(u(K),u(I),u(H),u(G))},s.\u0275cmp=v({type:s,selectors:[["app-login"]],decls:29,vars:10,consts:[["fullscreen","",1,"ion-padding"],[2,"max-width","420px","margin","8vh auto 0"],[2,"border-radius","16px"],["color","primary"],["lines","none"],["name","mail-outline","slot","start","color","primary"],["type","email","autocomplete","email","placeholder","Correo",3,"ngModelChange","keyup.enter","ngModel"],["lines","none",2,"margin-top","10px"],["name","lock-closed-outline","slot","start","color","primary"],["type","password","autocomplete","current-password","placeholder","Contrase\xF1a",3,"ngModelChange","keyup.enter","ngModel"],["color","danger","style","display:block; margin-top:12px;",4,"ngIf"],["expand","block","size","large","color","primary",2,"margin-top","16px","border-radius","12px",3,"click","disabled"],["slot","start",4,"ngIf"],[2,"display","flex","align-items","center","gap","8px","margin","14px 0 6px"],[2,"flex","1","height","1px","background","rgba(0,0,0,.08)"],[2,"opacity",".6"],["expand","block","fill","clear",2,"border-radius","12px",3,"routerLink","disabled"],[2,"text-align","center","margin-top","10px"],["fill","clear","size","small","color","medium",1,"recovery-button",3,"click","disabled"],["color","danger",2,"display","block","margin-top","12px"],["slot","start"]],template:function(t,e){t&1&&(n(0,"ion-content",0)(1,"div",1)(2,"ion-card",2)(3,"ion-card-header")(4,"ion-card-title",3),l(5,"Iniciar sesi\xF3n"),r(),n(6,"ion-card-subtitle"),l(7,"Bienvenido/a \u{1F44B}"),r()(),n(8,"ion-card-content")(9,"ion-item",4),m(10,"ion-icon",5),n(11,"ion-input",6),x("ngModelChange",function(d){return y(e.email,d)||(e.email=d),d}),h("keyup.enter",function(){return e.login()}),r()(),n(12,"ion-item",7),m(13,"ion-icon",8),n(14,"ion-input",9),x("ngModelChange",function(d){return y(e.password,d)||(e.password=d),d}),h("keyup.enter",function(){return e.login()}),r()(),f(15,Y,2,1,"ion-text",10),n(16,"ion-button",11),h("click",function(){return e.login()}),f(17,Z,1,0,"ion-spinner",12),l(18),r(),n(19,"div",13),m(20,"div",14),n(21,"small",15),l(22,"o"),r(),m(23,"div",14),r(),n(24,"ion-button",16),l(25," Crear cuenta "),r(),n(26,"div",17)(27,"ion-button",18),h("click",function(){return e.requestPasswordRecovery()}),l(28," Recuperar Contrase\xF1a "),r()()()()()()),t&2&&(o(11),_("ngModel",e.email),o(3),_("ngModel",e.password),o(),g("ngIf",e.errorMsg),o(),g("disabled",e.loading),o(),g("ngIf",e.loading),o(),b(" ",e.loading?"Ingresando\u2026":"Ingresar"," "),o(6),g("routerLink",w(9,X))("disabled",e.loading),o(3),g("disabled",e.loading||e.loadingRecovery))},dependencies:[J,L,R,B,F,D,W,j,A,z,U,N,q,S,V,P,M,O,E,T,k],styles:['@charset "UTF-8";[_nghost-%COMP%]{--bg1: #f7fbff;--bg2: #e8f0ff;--card-bg: #ffffff}ion-content[_ngcontent-%COMP%]{--background: linear-gradient(180deg, var(--bg1) 0%, var(--bg2) 100%)}ion-toolbar[_ngcontent-%COMP%]{--background: transparent;--color: var(--ion-text-color);--border-color: transparent}ion-card[_ngcontent-%COMP%]{max-width:420px;margin:8vh auto 0;border-radius:16px;background:var(--card-bg);box-shadow:0 10px 30px #2b58761f}ion-card-title[_ngcontent-%COMP%]{font-weight:700}ion-card-subtitle[_ngcontent-%COMP%]{margin-top:4px;opacity:.7}ion-item[_ngcontent-%COMP%]{--background: transparent;--padding-start: 12px;--inner-padding-end: 12px;--min-height: 54px;border:1px solid rgba(25,71,170,.15);border-radius:12px;margin-top:12px;transition:border-color .16s ease,box-shadow .16s ease}ion-item.item-has-focus[_ngcontent-%COMP%]{border-color:var(--ion-color-primary);box-shadow:0 0 0 3px #3b82f626}ion-icon[slot=start][_ngcontent-%COMP%]{margin-right:6px;opacity:.9}ion-input[_ngcontent-%COMP%]{font-size:16px}ion-button[_ngcontent-%COMP%]{--border-radius: 12px;--box-shadow: 0 6px 18px rgba(59, 130, 246, .35)}ion-text[color=danger][_ngcontent-%COMP%]{display:block;font-size:.9rem}@media (prefers-color-scheme: dark){[_nghost-%COMP%]{--bg1: #0b1220;--bg2: #0f1630;--card-bg: #141a2a}ion-card[_ngcontent-%COMP%]{box-shadow:0 14px 34px #00000073}ion-item[_ngcontent-%COMP%]{border-color:#ffffff14}}.recovery-button[_ngcontent-%COMP%]{--box-shadow: none !important;border:none!important;font-weight:500}ion-button[fill=clear][_ngcontent-%COMP%]{--box-shadow: none !important}ion-button[fill=clear][color=medium][_ngcontent-%COMP%]{color:var(--ion-color-medium-shade, #737373)!important;--background-hover: transparent !important;--background-focused: transparent !important;--background-activated: transparent !important}']});let a=s;return a})();export{ce as LoginPage};
