import{a as ee}from"./chunk-CATCBSYX.js";import{a as Z}from"./chunk-CL4KBMSP.js";import"./chunk-TX5AFJTF.js";import"./chunk-66QFWZLQ.js";import{A as d,B as v,C,Ea as T,Fa as z,Ga as N,Ha as A,Ia as R,Ja as F,Ka as V,Ma as D,Na as L,O as M,P as w,Pa as j,Qa as q,Ra as B,S as O,Sa as U,Ta as $,_ as y,_a as H,ba as S,bb as Y,cb as G,db as W,f as _,g as h,i as c,ib as J,j as x,k as I,lb as K,m as g,mb as Q,o as l,p as r,q as n,r as m,s as E,t as P,ta as k,u as b,v as u,vb as X,w as p}from"./chunk-H7HGEQUX.js";import"./chunk-G4GOZ2R2.js";import"./chunk-2GHFZAQB.js";import"./chunk-QUJFQN2Y.js";import"./chunk-VBARJE22.js";import"./chunk-6T3MRKSY.js";import"./chunk-LG5HFCS7.js";import"./chunk-PTM2QU7L.js";import"./chunk-Z7QLWI7J.js";import"./chunk-DNXVUVY2.js";import"./chunk-JS56SECH.js";import"./chunk-GFYYGWWH.js";import"./chunk-EXVGCGBZ.js";import"./chunk-IACAUHTZ.js";import"./chunk-WIVIOYVM.js";import"./chunk-ULQSOQCK.js";import"./chunk-JOPIHTUJ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-EKNMT7ZB.js";import"./chunk-CKP3SGE2.js";import"./chunk-K6CL52MX.js";import{j as f}from"./chunk-VI73JOY6.js";function ie(t,a){t&1&&(r(0,"div",10),m(1,"ion-spinner",11),r(2,"p"),d(3,"Cargando lista de espacios..."),n()())}function ne(t,a){if(t&1&&m(0,"ion-img",18),t&2){let i=p().$implicit;l("src",i.imagen_url)}}function oe(t,a){if(t&1){let i=b();r(0,"ion-card",13),u("click",function(){let o=_(i).$implicit,s=p(2);return h(s.goToDetail(o.id_espacio))}),g(1,ne,1,1,"ion-img",14),r(2,"ion-card-header")(3,"ion-card-title"),d(4),n(),r(5,"ion-card-subtitle"),d(6),n()(),r(7,"ion-card-content")(8,"ion-grid")(9,"ion-row")(10,"ion-col",15)(11,"p")(12,"strong"),d(13,"Tipo:"),n(),d(14),n()(),r(15,"ion-col",16)(16,"p")(17,"strong"),d(18,"Capacidad:"),n(),d(19),n()()()(),r(20,"p",17),d(21),n()()()}if(t&2){let i=a.$implicit,e=p(2);c(),l("ngIf",i.imagen_url),c(3),v(i.nombre),c(2),v(i.direccion_completa||"Direcci\xF3n no especificada"),c(8),C(" ",e.getTipoNombre(i.tipo)),c(5),C(" ",i.capacidad),c(2),C(" ",i.descripcion?i.descripcion.length>50?i.descripcion.substring(0,50)+"...":i.descripcion:"Sin descripci\xF3n"," ")}}function re(t,a){if(t&1&&(E(0),g(1,oe,22,6,"ion-card",12),P()),t&2){let i=p();c(),l("ngForOf",i.espacios)}}function ae(t,a){if(t&1){let i=b();r(0,"ion-button",20),u("click",function(){_(i);let o=p(2);return h(o.irACrearEspacio())}),d(1," Crear Nuevo Espacio "),n()}}function ce(t,a){if(t&1&&(r(0,"div",10)(1,"p"),d(2,"No se encontraron espacios disponibles."),n(),g(3,ae,2,0,"ion-button",19),n()),t&2){let i=p();c(3),l("ngIf",i.isAdmin)}}function se(t,a){if(t&1){let i=b();r(0,"ion-fab",21)(1,"ion-button",22),u("click",function(){_(i);let o=p();return h(o.irACrearEspacio())}),m(2,"ion-icon",23),d(3," Nuevo Espacio "),n()()}}var Ce=(()=>{let a=class a{constructor(e,o,s){this.espaciosService=e,this.router=o,this.authService=s,this.espacios=[],this.isLoading=!1,this.error=null,this.isAdmin=!1,this.tiposEspacioMap=new Map([[1,"Cancha"],[2,"Sede"],[3,"Parque"]])}ngOnInit(){this.checkUserRole(),this.cargar()}ionViewWillEnter(){this.isLoading=!0,setTimeout(()=>this.cargar(),600)}cargar(){return f(this,null,function*(){yield this.cargarEspacios()})}checkUserRole(){return f(this,null,function*(){try{this.isAdmin=yield this.authService.checkIfAdmin()}catch(e){console.error("No se pudo determinar el rol del usuario:",e),this.isAdmin=!1}})}cargarEspacios(e){return f(this,null,function*(){e||(this.isLoading=!0,this.error=null);try{this.espacios=yield this.espaciosService.obtenerEspacios()}catch(o){this.error=o.message||"Error desconocido al cargar los espacios.",this.espacios=[]}finally{this.isLoading=!1,e&&e.target.complete()}})}getTipoNombre(e){if(e==null)return"N/A";let o=parseInt(e.toString(),10);return isNaN(o)?"N/A":this.tiposEspacioMap.get(o)||"Desconocido"}goToDetail(e){this.router.navigateByUrl(`/espacios/${e}`)}irACrearEspacio(){this.router.navigateByUrl("espacio/crear")}handleRefresh(e){return f(this,null,function*(){try{yield this.cargarEspacios()}finally{e.target?.complete?.()}})}};a.\u0275fac=function(o){return new(o||a)(x(ee),x(y),x(Z))},a.\u0275cmp=I({type:a,selectors:[["app-espacios"]],decls:14,vars:6,consts:[[1,"rb-header",3,"translucent"],["slot","start"],["menu","mainMenu","autoHide","false"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],["pullingText","Desliza para refrescar","refreshingSpinner","crescent","refreshingText","Actualizando..."],[1,"page-wrap","ion-padding"],["class","ion-text-center ion-padding",4,"ngIf"],[4,"ngIf"],["slot","fixed","vertical","bottom","horizontal","end",4,"ngIf"],[1,"ion-text-center","ion-padding"],["name","crescent","color","primary"],["class","card","button","true","detail","false",3,"click",4,"ngFor","ngForOf"],["button","true","detail","false",1,"card",3,"click"],["alt","Imagen del espacio","style","width: 100%; height: 180px; object-fit: cover;",3,"src",4,"ngIf"],["size","6"],["size","6",1,"ion-text-end"],[1,"ion-padding-top-sm","ion-text-start","ion-text-sm"],["alt","Imagen del espacio",2,"width","100%","height","180px","object-fit","cover",3,"src"],["fill","solid","size","large",3,"click",4,"ngIf"],["fill","solid","size","large",3,"click"],["slot","fixed","vertical","bottom","horizontal","end"],["color","primary","fill","solid",1,"fab-squared-button",3,"click"],["name","add-outline","slot","start"]],template:function(o,s){o&1&&(r(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),m(3,"ion-menu-button",2),n(),r(4,"ion-title"),d(5,"Nuestros Espacios"),n()()(),r(6,"ion-content",3)(7,"ion-refresher",4),u("ionRefresh",function(te){return s.handleRefresh(te)}),m(8,"ion-refresher-content",5),n(),r(9,"div",6),g(10,ie,4,0,"div",7)(11,re,2,1,"ng-container",8)(12,ce,4,1,"div",7),n(),g(13,se,4,0,"ion-fab",9),n()),o&2&&(l("translucent",!0),c(6),l("fullscreen",!0),c(4),l("ngIf",s.isLoading),c(),l("ngIf",!s.isLoading&&(s.espacios==null?null:s.espacios.length)),c(),l("ngIf",!s.isLoading&&!(s.espacios!=null&&s.espacios.length)),c(),l("ngIf",s.isAdmin))},dependencies:[X,T,z,N,A,R,F,V,D,L,j,q,B,U,$,H,Y,G,W,J,K,Q,O,M,w,k,S],styles:['@charset "UTF-8";[_nghost-%COMP%], html[_nghost-%COMP%], html   [_nghost-%COMP%]{color-scheme:light!important;--rb-primary: #2563eb;--rb-bg: #f5f7fb;--rb-text: #0f172a;--rb-muted: #475569;--ion-text-color: var(--rb-text);--ion-background-color: var(--rb-bg);--ion-item-background: #ffffff;--ion-card-background: #ffffff}.rb-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: linear-gradient(135deg, var(--rb-primary), #60a5fa);--color: #fff;--border-color: transparent}.page-wrap[_ngcontent-%COMP%]{max-width:960px;margin:0 auto;padding-top:1px}ion-card.card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;border:1px solid rgba(2,6,23,.08);box-shadow:0 12px 28px #0206171a;overflow:hidden;margin-bottom:16px;transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}ion-card.card[_ngcontent-%COMP%]:hover{box-shadow:0 14px 30px #02061726}ion-card.card[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 8px 24px #02061714}ion-card.card[_ngcontent-%COMP%]   ion-card-header[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid rgba(2,6,23,.06);padding-bottom:8px}ion-card.card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{color:var(--rb-text);font-weight:800;font-size:1.3rem}ion-card.card[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:#64748b;font-weight:600;margin-top:4px;font-size:.9rem}ion-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;color:var(--rb-text)}ion-card-content[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--rb-muted);font-weight:600}ion-grid[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.95rem}.ion-padding-top-sm[_ngcontent-%COMP%]{padding-top:8px}.ion-text-sm[_ngcontent-%COMP%]{font-size:.9rem;color:var(--rb-muted)}ion-fab[_ngcontent-%COMP%]{--height: auto;--width: auto;--offset-bottom: 20px;--offset-end: 20px}.fab-squared-button[_ngcontent-%COMP%]{--border-radius: 12px;--padding-start: 18px;--padding-end: 18px;--padding-top: 14px;--padding-bottom: 14px;height:auto;font-weight:700;font-size:1.05rem;box-shadow:0 10px 18px #2563eb4d}.fab-squared-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.4em;margin-inline-end:8px}.fab-squared-button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 6px 14px #2563eb33}@media (prefers-color-scheme: dark){[_nghost-%COMP%]{--ion-background-color: var(--rb-bg);--ion-card-background: #ffffff;--ion-item-background: #ffffff;--ion-text-color: var(--rb-text)}}']});let t=a;return t})();export{Ce as EspaciosPage};
