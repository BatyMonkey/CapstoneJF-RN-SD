import{a as h}from"./chunk-CGH6KSUE.js";import{B as m,Ea as R,Fa as U,Ga as B,Ha as V,Ia as $,J as u,Ja as H,K as y,L as O,La as Y,M as E,Ma as j,N as S,O as N,P as k,Pa as G,Q as T,Qa as q,R as z,Z as A,Za as K,aa as F,cb as W,f as x,g as b,h as C,hb as J,i as r,j as v,k as w,kb as L,lb as Q,m as p,n as l,o as n,p as a,q as _,sa as D,t as I,u as P,ub as X,v as g,vb as Z,w as M,z as d}from"./chunk-JZTRD5FY.js";import"./chunk-G4GOZ2R2.js";import"./chunk-2GHFZAQB.js";import"./chunk-QUJFQN2Y.js";import"./chunk-VBARJE22.js";import"./chunk-6T3MRKSY.js";import"./chunk-LG5HFCS7.js";import"./chunk-PTM2QU7L.js";import"./chunk-Z7QLWI7J.js";import"./chunk-DNXVUVY2.js";import"./chunk-JS56SECH.js";import"./chunk-GFYYGWWH.js";import"./chunk-EXVGCGBZ.js";import"./chunk-IACAUHTZ.js";import"./chunk-WIVIOYVM.js";import"./chunk-ULQSOQCK.js";import"./chunk-JOPIHTUJ.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-EKNMT7ZB.js";import"./chunk-CKP3SGE2.js";import"./chunk-K6CL52MX.js";import{j as f}from"./chunk-VI73JOY6.js";function ee(e,o){e&1&&(n(0,"div",8),_(1,"ion-spinner",9),n(2,"p"),d(3,"Cargando noticias..."),a()())}function te(e,o){if(e&1&&(n(0,"div",16),_(1,"img",17),a()),e&2){let t=g().$implicit;r(),l("src",t.url_foto==null?null:t.url_foto[0],C)}}function ie(e,o){if(e&1&&(n(0,"span"),d(1),u(2,"date"),a()),e&2){let t=g().$implicit;r(),m(" | ",y(2,1,t.fecha_creacion,"shortDate")," ")}}function ne(e,o){if(e&1&&(n(0,"p",18),d(1),u(2,"slice"),a()),e&2){let t=o.ngIf;r(),m(" ",O(2,1,t,0,100),"\u2026 ")}}function oe(e,o){e&1&&(n(0,"p",19),d(1,"[Sin resumen]"),a())}function ae(e,o){if(e&1){let t=I();n(0,"ion-col",11)(1,"ion-card",12),P("click",function(){let s=x(t).$implicit,c=g(2);return b(c.verDetalle(s.id))}),p(2,te,2,1,"div",13),n(3,"ion-card-header")(4,"ion-card-title",14),d(5),a(),n(6,"ion-card-subtitle"),d(7),p(8,ie,3,4,"span",6),a()(),n(9,"ion-card-content"),p(10,ne,3,5,"p",15)(11,oe,2,0,"ng-template",null,0,E),a()()()}if(e&2){let t=o.$implicit,i=M(12);r(2),l("ngIf",t.url_foto==null?null:t.url_foto.length),r(3),m(" ",t.titulo," "),r(2),m(" ",t.nombre_autor||"An\xF3nimo"," "),r(),l("ngIf",t.fecha_creacion),r(2),l("ngIf",t.parrafos==null?null:t.parrafos[0])("ngIfElse",i)}}function re(e,o){if(e&1&&(n(0,"ion-grid")(1,"ion-row"),p(2,ae,13,6,"ion-col",10),a()()),e&2){let t=g();r(2),l("ngForOf",t.noticias)}}function ce(e,o){e&1&&(n(0,"div",20)(1,"h2"),d(2,"No hay noticias disponibles"),a(),n(3,"p"),d(4,"S\xE9 el primero en crear una noticia usando el bot\xF3n \u201CNueva Noticia\u201D."),a()())}var xe=(()=>{let o=class o{constructor(i){this.router=i,this.noticias=[],this.estaCargando=!1,this.esAdmin=!1,this.usuarioActual=null,this.supabase=Z(h.supabaseUrl,h.supabaseAnonKey)}ngOnInit(){this.cargarEstadoYNoticias()}ionViewWillEnter(){this.cargarEstadoYNoticias()}cargarEstadoYNoticias(){return f(this,null,function*(){yield this.cargarEstadoUsuario(),yield this.cargarNoticias()})}cargarEstadoUsuario(){return f(this,null,function*(){try{let{data:{user:i}}=yield this.supabase.auth.getUser();if(this.usuarioActual=i,i){let{data:s,error:c}=yield this.supabase.from("usuario").select("rol").eq("user_id",i.id).single();if(c&&c.code!=="PGRST116")throw c;this.esAdmin=s?.rol==="administrador"}else this.esAdmin=!1}catch(i){console.error("Error al cargar estado de usuario:",i),this.esAdmin=!1}})}cargarNoticias(){return f(this,null,function*(){this.estaCargando=!0;try{let{data:i,error:s}=yield this.supabase.from("noticias").select("id, titulo, url_foto, nombre_autor, fecha_creacion, parrafos").order("fecha_creacion",{ascending:!1});if(s)throw s;this.noticias=i}catch(i){console.error("Error al cargar noticias:",i)}finally{this.estaCargando=!1}})}verDetalle(i){this.router.navigate(["/noticias",i])}navegarACrearNoticia(){this.router.navigate(["noticias/crear"])}};o.\u0275fac=function(s){return new(s||o)(v(A))},o.\u0275cmp=w({type:o,selectors:[["app-noticias"]],decls:10,vars:4,consts:[["sinResumen",""],[1,"rb-header"],["slot","start"],["menu","mainMenu","autoHide","false"],[1,"news",3,"fullscreen"],["class","loading",4,"ngIf"],[4,"ngIf"],["class","empty",4,"ngIf"],[1,"loading"],["name","crescent"],["size","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","4"],[3,"click"],["class","card-image-container",4,"ngIf"],[1,"card-title","ion-text-wrap"],["class","card-excerpt",4,"ngIf","ngIfElse"],[1,"card-image-container"],["alt","Miniatura",1,"card-image",3,"src"],[1,"card-excerpt"],[1,"card-excerpt-placeholder"],[1,"empty"]],template:function(s,c){s&1&&(n(0,"ion-header",1)(1,"ion-toolbar")(2,"ion-buttons",2),_(3,"ion-menu-button",3),a(),n(4,"ion-title"),d(5,"Noticias"),a()()(),n(6,"ion-content",4),p(7,ee,4,0,"div",5)(8,re,3,1,"ion-grid",6)(9,ce,5,0,"div",7),a()),s&2&&(r(6),l("fullscreen",!0),r(),l("ngIf",c.estaCargando),r(),l("ngIf",!c.estaCargando&&(c.noticias==null?null:c.noticias.length)),r(),l("ngIf",!c.estaCargando&&(!c.noticias||!c.noticias.length)))},dependencies:[X,R,U,B,V,$,H,Y,j,G,q,K,W,J,L,Q,z,S,N,D,F,T,k],styles:['@charset "UTF-8";[_nghost-%COMP%]{color-scheme:light;--rb-primary: #2563eb;--rb-text: #0f172a;--rb-muted: #64748b;--rb-sep: rgba(2, 6, 23, .06);--ion-background-color: #ffffff}.rb-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: linear-gradient(135deg, var(--rb-primary), #60a5fa);--color: #fff;--border-color: transparent;--min-height: 56px}.news[_ngcontent-%COMP%]{--background: #fff;padding-bottom:8px}.news[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%]{--ion-grid-padding: 6px}.news[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:10px}ion-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;border:1px solid var(--rb-sep);box-shadow:0 10px 24px #0206171a;overflow:hidden;transition:transform .08s ease,box-shadow .12s ease,border-color .12s ease}ion-card[_ngcontent-%COMP%]:active{transform:scale(.996);box-shadow:0 12px 28px #0206171f;border-color:#2563eb2e}.card-image-container[_ngcontent-%COMP%]{width:100%;height:200px;overflow:hidden;background:#f1f5f9;border-bottom:1px solid var(--rb-sep)}@media (min-width: 768px){.card-image-container[_ngcontent-%COMP%]{height:230px}}.card-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}ion-card-header[_ngcontent-%COMP%]{background:#fff;padding:12px 14px 8px;border-bottom:1px solid var(--rb-sep)}.card-title[_ngcontent-%COMP%]{margin:0 0 2px;color:var(--rb-text);font-weight:800;font-size:17px;line-height:1.25;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}ion-card-subtitle[_ngcontent-%COMP%]{color:var(--rb-muted);font-weight:600;letter-spacing:.2px;font-size:12.5px}ion-card-content[_ngcontent-%COMP%]{padding:10px 14px 14px}.card-excerpt[_ngcontent-%COMP%]{color:#334155;font-weight:500;font-size:14.5px;line-height:1.4;margin:2px 0 0;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.card-excerpt-placeholder[_ngcontent-%COMP%]{color:#94a3b8;font-style:italic;margin:2px 0 0}.loading[_ngcontent-%COMP%], .empty[_ngcontent-%COMP%]{text-align:center;color:#475569;padding:20px 12px}.loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:8px}@media (prefers-reduced-motion: reduce){ion-card[_ngcontent-%COMP%]{transition:none}}']});let e=o;return e})();export{xe as NoticiasPage};
