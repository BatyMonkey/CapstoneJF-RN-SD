<ion-content class="ion-padding" fullscreen>
  <div style="max-width:420px; margin: 8vh auto 0;">
    <ion-card style="border-radius:16px;">
      <ion-card-header>
        <ion-card-title color="primary">Actualizar Contraseña</ion-card-title>
        <ion-card-subtitle>Ingresa tu nueva contraseña para acceder.</ion-card-subtitle>
      </ion-card-header>

      <ion-card-content>
        <ion-text color="success" *ngIf="successMsg" style="display:block; margin-bottom:12px;">
          <strong>{{ successMsg }}</strong>
        </ion-text>

        <form #f="ngForm" (ngSubmit)="updatePassword(f)">
          <ion-item lines="none">
            <ion-icon name="lock-closed-outline" slot="start" color="primary"></ion-icon>
            <ion-input
              type="password"
              placeholder="Nueva Contraseña (mínimo 6 caracteres)"
              name="newPassword"
              [(ngModel)]="newPassword"
              required
              minlength="6">
            </ion-input>
          </ion-item>

          <ion-item lines="none" style="margin-top:10px;">
            <ion-icon name="lock-closed-outline" slot="start" color="primary"></ion-icon>
            <ion-input
              type="password"
              placeholder="Confirmar Nueva Contraseña"
              name="confirmPassword"
              [(ngModel)]="confirmPassword"
              required>
            </ion-input>
          </ion-item>

          <ion-text color="danger" *ngIf="errorMsg" style="display:block; margin-top:12px;">
            {{ errorMsg }}
          </ion-text>

          <ion-button
            type="submit"
            expand="block"
            size="large"
            color="primary"
            class="cta"
            [disabled]="loading || !f.valid"
            style="margin-top:20px; border-radius:12px;">
            <ion-spinner slot="start" *ngIf="loading"></ion-spinner>
            {{ loading ? 'Actualizando…' : 'Cambiar Contraseña' }}
          </ion-button>

          <ion-button
            type="button"
            expand="block"
            fill="clear"
            color="medium"
            (click)="goToLogin()"
            [disabled]="loading"
            style="margin-top: 10px; --padding-top: 0; --padding-bottom: 0;">
            Volver a Iniciar Sesión
          </ion-button>
        </form>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
