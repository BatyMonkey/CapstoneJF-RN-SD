<ion-header class="rb-header">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button menu="mainMenu" autoHide="false"></ion-menu-button>
    </ion-buttons>
    <ion-title>Reserva de Espacio/Terreno</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding reserva" [fullscreen]="true">
  <!-- Pull to refresh sin agregar mÃ©todos al TS -->
  <ion-refresher
    slot="fixed"
    (ionRefresh)="cargarEspaciosDisponibles(); $any($event.target).complete()">
    <ion-refresher-content
      pullingText="Desliza para refrescar"
      refreshingSpinner="crescent"
      refreshingText="Actualizando...">
    </ion-refresher-content>
  </ion-refresher>

  <ion-card class="card">
    <ion-card-header>
      <ion-card-title>Formulario de Reserva</ion-card-title>
      <ion-card-subtitle>Completa los datos para solicitar un espacio</ion-card-subtitle>
    </ion-card-header>

    <ion-card-content>
      <form [formGroup]="solicitudForm" (ngSubmit)="enviarSolicitud()">

        <!-- SelecciÃ³n del Espacio -->
        <ion-item class="field">
          <ion-label position="stacked">Selecciona un Espacio</ion-label>
          <ion-select
            formControlName="id_espacio"
            interface="popover"
            placeholder="Elige un espacio disponible">
            <ion-select-option
              *ngFor="let espacio of espaciosDisponibles"
              [value]="espacio.id_espacio">
              {{ espacio.nombre }} â€” {{ espacio.tipo || 'General' }}
            </ion-select-option>
          </ion-select>
        </ion-item>

        <ion-note color="medium" *ngIf="espaciosDisponibles?.length === 0">
          No hay espacios disponibles por ahora.
        </ion-note>

        <!-- DescripciÃ³n -->
        <ion-item class="field">
          <ion-label position="stacked">DescripciÃ³n / Comentario</ion-label>
          <ion-textarea
            formControlName="descripcion"
            placeholder="Agrega una nota o detalle (opcional)">
          </ion-textarea>
        </ion-item>

        <!-- Datos del Evento -->
        <ion-item class="field">
          <ion-label position="stacked">TÃ­tulo del Evento</ion-label>
          <ion-input
            formControlName="evento_titulo"
            placeholder="Ej: Campeonato de fÃºtbol">
          </ion-input>
        </ion-item>

        <ion-item class="field">
          <ion-label position="stacked">DescripciÃ³n del Evento</ion-label>
          <ion-textarea
            formControlName="evento_descripcion"
            placeholder="Describe el evento">
          </ion-textarea>
        </ion-item>

        <!-- Fechas -->
        <div class="grid-2">
          <ion-item class="field">
            <ion-label position="stacked">Fecha de Inicio</ion-label>
            <ion-datetime
              formControlName="evento_inicio"
              presentation="date-time"
              minute-values="0,15,30,45">
            </ion-datetime>
          </ion-item>

          <ion-item class="field">
            <ion-label position="stacked">Fecha de TÃ©rmino</ion-label>
            <ion-datetime
              formControlName="evento_fin"
              presentation="date-time"
              minute-values="0,15,30,45">
            </ion-datetime>
          </ion-item>
        </div>

        <!-- AcciÃ³n -->
        <div class="actions">
          <ion-button
            expand="block"
            type="submit"
            color="success"
            [disabled]="solicitudForm.invalid">
            ðŸ’³ Reservar Espacio
          </ion-button>
        </div>
      </form>
    </ion-card-content>
  </ion-card>
</ion-content>
