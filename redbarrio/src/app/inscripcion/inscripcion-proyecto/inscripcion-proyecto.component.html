<ion-header>
  <ion-toolbar color="primary">
    <ion-title>Inscripción a Proyectos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <form *ngIf="inscripcionForm" [formGroup]="inscripcionForm" (ngSubmit)="enviarPostulacion()">

    <!-- Selector de proyecto -->
    <ion-item>
      <ion-label position="stacked">Selecciona un Proyecto</ion-label>
      <ion-select formControlName="id_proyecto" placeholder="Elige un proyecto disponible">
        <ion-select-option *ngFor="let p of proyectos" [value]="p.id_proyecto">
          {{ p.titulo }}
        </ion-select-option>
      </ion-select>
    </ion-item>

    <!-- Mostrar detalles del proyecto seleccionado -->
    <ng-container *ngIf="inscripcionForm.value.id_proyecto as selectedId">
      <ng-container *ngFor="let p of proyectos">
        <ion-card *ngIf="p.id_proyecto === selectedId">
          <ion-card-header>
            <ion-card-title color="primary">{{ p.titulo }}</ion-card-title>
            <ion-card-subtitle>Estado: {{ p.estado | titlecase }}</ion-card-subtitle>
          </ion-card-header>
          <ion-card-content>
            <p>{{ p.descripcion }}</p>
          </ion-card-content>
        </ion-card>
      </ng-container>
    </ng-container>

    <!-- Campo de motivación -->
    <ion-item>
      <ion-label position="stacked">Motivación / Comentario</ion-label>
      <ion-textarea
        formControlName="descripcion"
        autoGrow="true"
        placeholder="Explica por qué deseas participar en este proyecto">
      </ion-textarea>
    </ion-item>

    <!-- Botón -->
    <ion-button expand="block" type="submit" [disabled]="inscripcionForm.invalid">
      Enviar Postulación
    </ion-button>

  </form>

</ion-content>
