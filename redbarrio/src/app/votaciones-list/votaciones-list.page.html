<!-- HERO HEADER (igual estilo que Certificados, sin hamburguesa) -->
<ion-header class="rb-hero-header" slot="fixed">
  <div class="rb-hero-container">
    <div class="rb-hero-info">
      <div class="rb-hero-logo">
        <img src="assets/icon/redbarrio.png" alt="Logo RedBarrio" />
      </div>
      <div class="rb-hero-text">
        <h1>RedBarrio</h1>
        <p>Tu comunidad conectada</p>
      </div>
    </div>
  </div>
</ion-header>

<ion-content class="vot-content" [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="cargarTodo($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <div class="vot-wrapper">

    <!-- ðŸ”¹ Tarjeta principal del mÃ³dulo (igual idea que "Certificados") -->
    <div class="vot-main-card">
      <div class="icon-circle">
        <ion-icon name="checkbox-outline"></ion-icon>
      </div>
      <div class="vot-main-text">
        <h2>Votaciones</h2>
        <p>Revisa y participa en las votaciones de tu comunidad.</p>
      </div>
    </div>

    <!-- TÃ­tulo interno (lo dejamos por si quieres usarlo como subtÃ­tulo) -->
    <div class="vot-header">
      <h2>Votaciones</h2>
    </div>

    <!-- PestaÃ±as Activas / Finalizadas -->
    <div class="vot-tabs">
      <button
        class="vot-tab"
        [class.active]="activeTab === 'activas'"
        (click)="activeTab = 'activas'">
        <span>Activas</span>
        <span class="badge">{{ activas.length }}</span>
      </button>

      <button
        class="vot-tab"
        [class.active]="activeTab === 'finalizadas'"
        (click)="activeTab = 'finalizadas'">
        <span>Finalizadas</span>
        <span class="badge">{{ finalizadas.length }}</span>
      </button>
    </div>

    <!-- ============ LISTA ACTIVAS ============ -->
    <div class="vot-list" *ngIf="activeTab === 'activas'">
      <ion-text color="danger" *ngIf="errorActivas">
        <p class="error-text">{{ errorActivas }}</p>
      </ion-text>

      <div class="loading" *ngIf="cargandoActivas">
        <ion-spinner name="crescent"></ion-spinner>
      </div>

      <ng-container *ngIf="!cargandoActivas">
        <ion-card
          class="vot-card vot-card--active"
          *ngFor="let v of activas; trackBy: trackById"
          (click)="irDetalle(v)">
          <div class="vot-card-header">
            <div class="titles">
              <h3 class="title">{{ v.titulo }}</h3>
              <p class="subtitle" *ngIf="v.descripcion">
                {{ v.descripcion }}
              </p>
            </div>
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </div>

          <div class="vot-card-footer vot-card-footer--active">
            <div class="left">
              <ion-icon name="time-outline"></ion-icon>
              <span>Cierra en:</span>
            </div>
            <div class="pills">
              <span class="pill">{{ tiempoRestante(v.fecha_fin) }}</span>
            </div>
          </div>
        </ion-card>

        <ion-text color="medium" *ngIf="!activas.length">
          <p class="empty">No hay votaciones activas en este momento.</p>
        </ion-text>
      </ng-container>
    </div>

    <!-- ============ LISTA FINALIZADAS ============ -->
    <div class="vot-list" *ngIf="activeTab === 'finalizadas'">
      <ion-text color="danger" *ngIf="errorFinalizadas">
        <p class="error-text">{{ errorFinalizadas }}</p>
      </ion-text>

      <div class="loading" *ngIf="cargandoFinalizadas">
        <ion-spinner name="crescent"></ion-spinner>
      </div>

      <ng-container *ngIf="!cargandoFinalizadas">
        <ion-card
          class="vot-card vot-card--finished"
          *ngFor="let v of finalizadas; trackBy: trackById"
          (click)="irDetalle(v)">
          <div class="vot-card-header">
            <div class="titles">
              <h3 class="title">{{ v.titulo }}</h3>
              <p class="subtitle" *ngIf="v.descripcion">
                {{ v.descripcion }}
              </p>
            </div>
            <ion-icon name="chevron-forward-outline"></ion-icon>
          </div>

          <div class="vot-card-footer vot-card-footer--finished">
            <div class="left">
              <ion-icon name="calendar-outline"></ion-icon>
              <span class="pill pill-finished">
                Finalizada el
                {{ v.fecha_fin | date:'d \'de\' MMMM \'de\' y' }}
              </span>
            </div>
          </div>
        </ion-card>

        <ion-text color="medium" *ngIf="!finalizadas.length">
          <p class="empty">No hay votaciones finalizadas.</p>
        </ion-text>
      </ng-container>
    </div>
  </div>
</ion-content>
