<!-- ============================================================
     HEADER — IDENTICO A DETALLE-NOTICIA
=============================================================== -->
<ion-header class="rb-hero-header">
  <div class="rb-hero-container">

    <div class="rb-hero-info">
      <div class="rb-hero-logo">
        <img src="assets/icon/redbarrio.png" alt="Logo RedBarrio" />
      </div>

      <div class="rb-hero-text">
        <h1>RedBarrio</h1>
        <p>Crear nueva votación para vecinos</p>
      </div>
    </div>

    <!-- BOTÓN VOLVER -->
    <button class="rb-hero-back" type="button" (click)="goBack()">
      <ion-icon name="chevron-back-outline"></ion-icon>
    </button>

  </div>
</ion-header>


<!-- ============================================================
     CONTENIDO
=============================================================== -->
<ion-content class="votacion-content">

  <div class="page-wrapper">


    <!-- ======================================================
         INFORMACIÓN GENERAL
    ========================================================== -->
    <div class="card-section">
      <h3 class="section-title">Información General</h3>

      <div class="form-group">
        <label>Título de la Votación <span class="req">*</span></label>
        <ion-input
          [(ngModel)]="titulo"
          class="input"
          placeholder="Ej: ¿Aprobar proyecto de áreas verdes?">
        </ion-input>
      </div>

      <div class="form-group">
        <label>Descripción <span class="req">*</span></label>
        <ion-textarea
          [(ngModel)]="descripcion"
          class="textarea"
          placeholder="Describe los detalles de la votación..."
          auto-grow="true">
        </ion-textarea>
      </div>

    </div>


    <!-- ======================================================
         PERIODO DE VOTACIÓN
    ========================================================== -->
    <div class="card-section">
      <h3 class="section-title">Periodo de Votación</h3>

      <!-- Inicio -->
      <div class="form-group">
        <label>Fecha y Hora de Inicio <span class="req">*</span></label>

        <div class="input-row">
          <div class="input-icon">
            <ion-icon name="calendar-outline"></ion-icon>
          </div>
          <input type="date" [(ngModel)]="fechaInicio" class="native-input" />
        </div>

        <div class="input-row">
          <div class="input-icon">
            <ion-icon name="time-outline"></ion-icon>
          </div>
          <input type="time" [(ngModel)]="horaInicio" class="native-input" />
        </div>
      </div>

      <!-- Término -->
      <div class="form-group">
        <label>Fecha y Hora de Término <span class="req">*</span></label>

        <div class="input-row">
          <div class="input-icon">
            <ion-icon name="calendar-outline"></ion-icon>
          </div>
          <input type="date" [(ngModel)]="fechaTermino" class="native-input" />
        </div>

        <div class="input-row">
          <div class="input-icon">
            <ion-icon name="time-outline"></ion-icon>
          </div>
          <input type="time" [(ngModel)]="horaTermino" class="native-input" />
        </div>
      </div>

    </div>


    <!-- ======================================================
         OPCIONES
    ========================================================== -->
    <div class="card-section">
      <div class="options-header">
        <h3 class="section-title">Opciones de Votación</h3>
        <span class="options-count">{{ opciones.length }} opciones</span>
      </div>

      <div class="options-list">

        <div class="opcion-card" *ngFor="let o of opciones; let i = index">

          <!-- Encabezado -->
          <div class="opcion-top">
            <div class="opcion-number">{{ i + 1 }}</div>
            <h4 class="opcion-title">Opción {{ i + 1 }}</h4>

            <button
              class="delete-opcion"
              *ngIf="opciones.length > 2"
              (click)="removeOpcion(i)">
              <ion-icon name="trash-outline"></ion-icon>
            </button>
          </div>

          <!-- Título -->
          <div class="form-group">
            <label>Título de la Opción <span class="req">*</span></label>
            <ion-input
              [(ngModel)]="o.titulo"
              class="input"
              placeholder="Ej: A favor">
            </ion-input>
          </div>

          <!-- Descripción -->
          <div class="form-group">
            <label>Descripción de la Opción</label>
            <ion-textarea
              [(ngModel)]="o.descripcion"
              class="textarea"
              placeholder="Describe esta opción..."
              auto-grow="true">
            </ion-textarea>
          </div>

          <!-- Imagen -->
          <div class="form-group">
            <label>Imagen (Opcional)</label>

            <div
              class="upload-box"
              (click)="fileInputs.toArray()[i].nativeElement.click()">

              <span *ngIf="!o.previewDataUrl">Subir imagen</span>

              <img
                *ngIf="o.previewDataUrl"
                [src]="o.previewDataUrl"
                class="preview-img" />

            </div>

            <input
              #fileInput
              type="file"
              accept="image/*"
              (change)="onFileSelected(i, $event)"
              hidden />
          </div>

        </div>

      </div>

      <!-- Botón agregar opción -->
      <button class="add-option-btn" (click)="addOpcion()">
        + Agregar Opción
      </button>

    </div>


    <!-- BOTÓN FINAL -->
    <button
      class="submit-btn"
      [disabled]="!puedeGuardar || loading"
      (click)="guardar()">
      Generar Votación
    </button>

  </div>

</ion-content>
